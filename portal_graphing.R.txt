library(tidyverse)
#install.packages('tidyverse')
surveys <- read.csv('data/portal_data_joined.csv')

#reassign factors for sex
levels(surveys$sex)[1]<-"missing"

#filter missing data - make sure factors are 
#reassigned
surveys_complete <- surveys %>%
  filter(species_id != "",
         !is.na(weight),
         !is.na(hindfoot_length),
         sex!="missing")

#extract the common species (by id)
#what are the common species?
species_counts <-surveys_complete %>%
  group_by(species_id) %>%
  tally

species_common <- species_counts %>% filter(n>=50)

#filter our surveys by list of common species
surveys_complete_common <- surveys_complete %>%
  filter(species_id %in% species_common$species_id)

##PLOTS
#Is hindfoot length correlated with weight?
ggplot(data = surveys_complete_common, aes(x=weight, y=hindfoot_length))+
  geom_point()

#are species different
base_plot <- ggplot(data = surveys_complete_common, aes(x=weight, y=hindfoot_length))
base_plot+geom_point(alpha = .1, aes(color=species_id))
base_plot+geom_point(alpha = .1,color='blue')
base_plot+geom_point(alpha = .1, aes(color=species_id))+
  scale_x_log10()
#add fitted line
base_plot+geom_point(alpha = .1, aes(color=species_id))+
  scale_x_log10()+
  geom_smooth(data=filter(surveys_complete_common,species_id =="PM"),method='lm', aes(color=species_id))

base_plot+geom_point(alpha = .1, aes(color=species_id,shape=species_id))+
  scale_x_log10()+
  geom_smooth(method='lm', aes(color=species_id,shape=species_id))
